<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --background: 0 0% 100%;
      --foreground: 222.2 84% 4.9%;
      --primary: 348 83% 47%;
      --primary-foreground: 0 0% 100%;
      --primary-light: 348 83% 57%;
      --primary-dark: 348 83% 37%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --border: 214.3 31.8% 91.4%;
      --gradient-hero: linear-gradient(135deg, hsl(348 83% 47%) 0%, hsl(0 70% 60%) 50%, hsl(355 70% 65%) 100%);
      --shadow-glow: 0 0 40px hsl(348 83% 60% / 0.4);
    }

    .bg-gradient-hero {
      background-image: var(--gradient-hero);
    }

    .shadow-glow {
      box-shadow: var(--shadow-glow);
    }

    .text-muted-foreground {
      color: hsl(var(--muted-foreground));
    }

    .border-border {
      border-color: hsl(var(--border));
    }

    .bg-primary {
      background-color: hsl(var(--primary));
    }

    .hover\:bg-primary-dark:hover {
      background-color: hsl(var(--primary-dark));
    }
  </style>
</head>

<body class="min-h-screen bg-gradient-hero overflow-hidden relative">
  <!-- Background Decorative Elements -->
  <div class="absolute inset-0 overflow-hidden">
    <div class="absolute -top-10 -left-10 w-40 h-40 bg-white/10 rounded-full blur-xl"></div>
    <div class="absolute top-20 right-20 w-32 h-32 bg-white/10 rounded-full blur-lg"></div>
    <div class="absolute bottom-40 left-20 w-24 h-24 bg-white/10 rounded-full blur-md"></div>
    <div class="absolute top-1/2 left-1/4 w-16 h-16 bg-white/10 rounded-full blur-sm"></div>
    <div class="absolute bottom-20 right-1/3 w-20 h-20 bg-white/10 rounded-full blur-md"></div>
  </div>

  <!-- Main Content -->
  <div class="lg:ml-72 relative z-10 min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8 py-12">
    <div class="w-full max-w-md">
      <div class="bg-white rounded-2xl shadow-glow p-8 border border-white/20">
        <h2 class="text-3xl font-bold text-center mb-6">Login</h2>

        <!-- Success Message -->
        <div th:if="${param.registered}" class="bg-green-50 border border-green-200 text-green-700 rounded-lg p-4 mb-4">
          <strong>Registration successful!</strong><br>
          <span th:if="${param.username}">Your username is: <strong th:text="${param.username}"></strong><br></span>
          Please wait for admin approval before you can login.<br>
          <small>After approval, use your <strong>username</strong> (not email or full name) to login.</small>
        </div>

        <!-- Error Message -->
        <div th:if="${param.error}" class="bg-red-50 border border-red-200 text-red-700 rounded-lg p-4 mb-4">
          <strong>Login Failed!</strong><br>
          Possible reasons:
          <ul class="list-disc pl-5 mt-2">
            <li>Invalid username or password</li>
            <li>Account is pending admin approval (check your registration email)</li>
            <li>Account has been restricted</li>
          </ul>
          <small class="mt-2 block"><strong>Note:</strong> Use your <strong>username</strong> (the one you entered
            during registration), not your email or full name.</small>
        </div>

        <!-- Logout Message -->
        <div th:if="${param.logout}" class="bg-blue-50 border border-blue-200 text-blue-700 rounded-lg p-4 mb-4">You
          have been logged out successfully.</div>

        <!-- Deleted Message -->
        <div th:if="${param.deleted}" class="bg-blue-50 border border-blue-200 text-blue-700 rounded-lg p-4 mb-4">Your
          account has been deleted.</div>

        <!-- Login Form -->
        <form th:action="@{/auth/login}" method="post" class="space-y-6">
          <div>
            <label for="username" class="block text-sm font-medium mb-2">
              Username <small class="text-muted-foreground">(not email or full name)</small>
            </label>
            <input type="text" id="username" name="username" placeholder="Enter your username" required
              class="w-full h-12 px-4 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all" />
            <small class="text-muted-foreground text-xs mt-1 block">Use the username you created during
              registration</small>
          </div>

          <div>
            <label for="password" class="block text-sm font-medium mb-2">Password</label>
            <input type="password" id="password" name="password" required
              class="w-full h-12 px-4 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all" />
          </div>

          <button type="submit"
            class="w-full h-12 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg shadow-lg transition-all duration-200 hover:shadow-xl">
            Login
          </button>
        </form>

        <!-- Registration Links -->
        <div class="text-center mt-6">
          <p class="text-sm text-gray-600 mb-3">Don't have an account?</p>
          <div class="flex items-center justify-center gap-3">
            <a th:href="@{/auth/register/donor}"
              class="flex-1 px-4 py-2.5 text-sm border-2 border-primary text-primary rounded-lg hover:bg-primary hover:text-white font-medium transition-all duration-200">
              Register as Donor
            </a>
            <a th:href="@{/auth/register/receiver}"
              class="flex-1 px-4 py-2.5 text-sm border-2 border-primary text-primary rounded-lg hover:bg-primary hover:text-white font-medium transition-all duration-200">
              Register as Receiver
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- Public Sidebar (included after main content to avoid CSRF issues) -->
  <div th:replace="~{fragments/public-sidebar :: publicSidebar}"></div>

  <!-- Public Sidebar Script -->
  <script th:replace="~{fragments/public-sidebar :: publicSidebarScript}"></script>
</body>

</html>